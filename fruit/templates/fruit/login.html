{% load static %}
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录 - 饭了么</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'fruit/login-register.css' %}">
    <style>
    .modal-bg {
        display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.3); justify-content: center; align-items: center;
    }
    .modal {
        background: #fff; border-radius: 10px; padding: 30px 30px 20px 30px; min-width: 300px; box-shadow: 0 8px 32px rgba(0,0,0,0.18);
        text-align: center;
    }
    .modal input[type=number] { width: 60px; padding: 5px; margin: 0 10px; }
    .modal .modal-btn { margin: 0 10px; padding: 6px 18px; border: none; border-radius: 5px; background: var(--primary-color); color: #fff; cursor: pointer; }
    .modal .modal-btn.cancel { background: #ccc; color: #333; }
    
    /* 消息样式 */
    .messages {
        margin-bottom: 20px;
        width: 100%;
    }
    .message {
        padding: 10px 15px;
        margin-bottom: 10px;
        border-radius: 5px;
        text-align: center;
        font-weight: 500;
    }
    .message.error {
        background-color: #ffebee;
        color: #d32f2f;
        border-left: 4px solid #d32f2f;
    }
    .message.success {
        background-color: #e8f5e9;
        color: #388e3c;
        border-left: 4px solid #388e3c;
    }
    </style>
</head>
<body>
    <!-- 头部导航 -->
    <header class="header">
        <div class="nav-container">
            <a href="/" class="logo">
                <i class="fas fa-carrot"></i> 饭了么
            </a>
        </div>
    </header>

    <!-- 主内容区 - 登录表单 -->
    <div class="main-container">
        <div class="auth-container">
            <!-- 装饰元素 -->
            <div class="decoration decoration-1"></div>
            <div class="decoration decoration-2"></div>
            <div class="decoration decoration-3"></div>
            <div class="decoration decoration-4"></div>
            
            <div class="auth-header">
                <h2>欢迎登录</h2>
                <p>登录您的账号，探索更多健康美食</p>
            </div>
            
            {% if messages %}
            <div class="messages">
                {% for message in messages %}
                <div class="message {% if message.tags %}{{ message.tags }}{% endif %}">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <form id="loginForm" method="post" action="{% url 'login_view' %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="username">账号</label>
                    <input type="text" id="username" name="username" class="form-control" placeholder="请输入用户名" required>
                </div>
                
                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" id="password" name="password" class="form-control" placeholder="请输入密码" required>
                </div>
                
                <div class="form-group">
                    <label for="verifycode">验证码</label>
                    <div class="verify-group">
                        <input type="text" id="verifycode" name="verifycode" class="form-control verify-code" placeholder="请输入验证码" required>
                        <div class="verify-img" id="captcha">A3B7</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">登录</button>
                </div>
            </form>
            
            <div class="auth-footer">
                <p>没有账号？ <a href="#" id="registerLink">立即注册</a></p>
            </div>
        </div>
    </div>
    
    <!-- 页脚 -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-column">
                <h3>关于我们</h3>
                <ul class="footer-links">
                    <li><a href="#">公司简介</a></li>
                    <li><a href="#">品牌故事</a></li>
                    <li><a href="#">团队介绍</a></li>
                    <li><a href="#">招贤纳士</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>客户服务</h3>
                <ul class="footer-links">
                    <li><a href="#">帮助中心</a></li>
                    <li><a href="#">售后服务</a></li>
                    <li><a href="#">配送说明</a></li>
                    <li><a href="#">退换政策</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>商务合作</h3>
                <ul class="footer-links">
                    <li><a href="#">供应商入驻</a></li>
                    <li><a href="#">广告合作</a></li>
                    <li><a href="#">渠道合作</a></li>
                    <li><a href="#">企业采购</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>关注我们</h3>
                <ul class="footer-links">
                    <li><a href="#"><i class="fab fa-weixin"></i> 微信公众号</a></li>
                    <li><a href="#"><i class="fab fa-weibo"></i> 新浪微博</a></li>
                    <li><a href="#"><i class="fab fa-tiktok"></i> 抖音</a></li>
                    <li><a href="#"><i class="fab fa-instagram"></i> Instagram</a></li>
                </ul>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; 2025 饭了么 - 健康食材商城 | 让新鲜食材直达您的厨房</p>
        </div>
    </footer>
    
    <!-- 注册模态框 -->
    <div id="registerModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="auth-header">
                <h2>创建账号</h2>
                <p>加入我们，开启健康美食之旅</p>
            </div>
            
            <form id="registerForm" method="post" action="{% url 'register_view' %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="regUsername">用户名</label>
                    <input type="text" id="regUsername" name="username" class="form-control" placeholder="请输入用户名" required>
                </div>
                
                <div class="form-group">
                    <label for="regPassword">密码</label>
                    <input type="password" id="regPassword" name="password" class="form-control" placeholder="请输入密码" required>
                </div>
                
                <div class="form-group">
                    <label for="regPassword2">确认密码</label>
                    <input type="password" id="regPassword2" name="password2" class="form-control" placeholder="请再次输入密码" required>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">注册</button>
                </div>
            </form>
        </div>
    </div>
    
    {% if messages %}
    <div class="message-container">
        {% for message in messages %}
        <div class="message {{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <script>
        // 登录表单处理
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            const captchaInput = document.getElementById('verifycode').value;
            const captcha = document.getElementById('captcha').textContent;
            
            if (captchaInput !== captcha) {
                e.preventDefault();
                alert('验证码错误，请重新输入');
                generateCaptcha();
            }
        });
        
        // 注册链接处理
        document.getElementById('registerLink').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('registerModal').style.display = 'block';
        });
        
        // 注册表单处理
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            const password2 = document.getElementById('regPassword2').value;
            
            if (!username || !password || !password2) {
                e.preventDefault();
                alert('请填写所有字段');
                return;
            }
            
            if (password !== password2) {
                e.preventDefault();
                alert('两次输入的密码不一致');
                return;
            }
        });
        
        // 关闭模态框
        document.querySelector('.close-btn').addEventListener('click', function() {
            document.getElementById('registerModal').style.display = 'none';
        });
        
        // 点击模态框外部关闭
        window.addEventListener('click', function(e) {
            const modal = document.getElementById('registerModal');
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
        
        // 生成验证码
        function generateCaptcha() {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let captcha = '';
            for (let i = 0; i < 4; i++) {
                captcha += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('captcha').textContent = captcha;
        }
        
        // 初始化验证码
        generateCaptcha();
        
        // 点击验证码刷新
        document.getElementById('captcha').addEventListener('click', generateCaptcha);
    </script>
</body>
</html> 